<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapfile merger</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <style>
        body {
            margin-left: 20px;
            margin-right: 20px;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light navbar-fixed-top">
        <a class="navbar-brand" href="/maputils">MapUtils</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item active">
              <a class="nav-link" href="/maputils">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="merger">Merger <span class="sr-only">(current)</span></a>
            </li>
            <!-- <li class="nav-item">
              <a class="nav-link" href="https://github.com/applefishpear/applefishpear.github.io/wiki/Ice-Dodo-Mapmaking-Tricks">Wiki</a>
            </li> -->
            <li class="nav-item">
              <a class="nav-link" href="https://pastebin.com/ipp0sUh1">Code</a>
            </li>
          </ul>
        </div>
      </nav>


    <h1>Mapfile merger (for v8.1)</h1>

    <h2>REQUIREMENTS TO USE</h2>
    <ul>
     <!--   <li>All URLs must be under the max limit.</li>-->  
        <li>Consecutive mapfiles must have the absolute correct coordinates. e.g. if the first map ends at (0,0,-1000), the second map should begin at (0,0, -1000) or slightly afterwards. 
            This should affect you if you split the map into 2 parts beginning at (0,0,0) so people can play through each part individually.
        </li>
        <li>Endings in the 1st URL will be removed. If you have multiple endings in your level, please contact me on discord (or somebody else familiar with mapfiles) to add them back in.</li>
        <!--<li>URLs should begin with: <i>https://icedodo.onionfist.com/singleplayer?mapUrl=</i></li> -->
        <li>If you need to combine more than two maps, combine the 1st and the 2nd map, then the 2nd and the 3rd map.</li>
        <li>The code MUST have the correct amount of lines and line breaks at the right places. (This should automatically be correct if you follow the steps below correctly)</li>
        <li>NULL characters may interfere with copying and pasting code. MAKE SURE the code is complete before you attempt to merge the maps.</li>
    </ul>

    <h2>HOW TO GET MAP CODE</h2>
    <b>Recommended:</b>
    <p><ol>
      <li>Get somebody with sufficient permissions to use p.mapfile on your first map URL.</li>
      <li>Copy and paste into the first textbox.</li>
      <li>Update your tinyURL to your second map. Use p.mapfile again.</li>
      <li>Copy and paste in the second textbox.</li>
      <li>The output should be fully merged with the correct map title and mapmaker name.</li>
    </ol></p>
          <span><b>OR</b></span><br><br>
          <ol>
            <li>Open up your first map URL in your browser.</li>
            <li>Press ctrl + shift + j (or other platform equivalents) to open up javascript console/developer tools.</li>
            <li>Go to the sources tab at the top.</li>
            <li>Find fn.onionfist.com on the left sidebar.</li>
            <li>Expand the dropdown and find the file that starts with "singleplayer?mapUrl=".</li>
            <li>Click on it to open it and on the right, there should be multi-lined code beginning with "var map = {"</li>
            <li>Ctrl + f and type in "msg". This shows all occurences of a message in the code. If you see any red null characters at the end of messages, delete them.</li>
            <li>Copy and paste all of the lines of code into the first textbox on this site without altering any lines.</li>
            <li>Repeat for the second map and paste it into the second textbox.</li>
            <li>After you get the outputted map code, change lines 2 and 4 to the title of your level and your mapmaker name.</li>
        </ol>

    <form action="" id="urlForm">
        <label for="url1">Map 1:</label><br>
        <textarea type="text" id="url1" name="url1" style="width:100%;"></textarea><br>
        <label for="url2">Map 2:</label><br>
        <textarea type="text" id="url2" name="url2" style="width:100%;"></textarea><br>
        <input type="submit" value="Merge">
      </form>
            <div>
            <b>Output:</b><br>
            <textarea readonly id="output" rows="10" cols="200"></textarea></div>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.9/beautify.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.9/beautify-css.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.9/beautify-html.js"></script>
      <script src="index.js" type="text/javascript"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
</body>
</html>